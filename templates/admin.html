<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='admin.css') }}">
</head>
<body>
    <div class="nav">
        <p>Welcome Admin</p>
        <ul>
            <a href="#"><li>Home</li></a>|
            <a href="{{ url_for('admin.userreg') }}"><li>Users</li></a>|
            <a href="{{ url_for('admin.summary') }}"><li>Summary</li></a>|
            <a href="{{ url_for('admin.editprofile') }}"><li>Edit Profile</li></a>|
            <a href="{{ url_for('logout.logout') }}"><li>Logout</li></a>
        </ul>
    </div>

    <div class="herohead">
        <div class="heading">
            <h1>Parking Lots</h1>
        </div>
    </div>

    <div class="newlot">
        <a href="{{ url_for('add_lots.add_lots') }}">+Add Lot</a>
    </div>

    {% for lot in parking_lots %}
        <div class="parking_lot_box">
            <h4>Parking Lot {{ lot.lot_id }}</h4>
            <div class="info">
                <p>Prime Location: {{ lot.primelocation }}</p>
                <p>Address: {{ lot.address }}</p>
                <p>Maximum spots: {{ lot.max_spots }}</p>
                <p>Price(per hour): {{ lot.price }}/-</p>
            </div>

            <div class="deledit">
                <a href="{{ url_for('edit_lot.edit_lot', lot_id=lot.lot_id) }}">Edit</a> |
                <a href="{{ url_for('admin.deletelot', lot_id=lot.lot_id) }}">Delete</a>
            </div>

            <div class="parking_lots">
                {% for spot in lot_spots_map.get(lot.lot_id, []) %}
                    {% if spot.status %}
                        <div class="parking_spots spot-occupied" style="background-color: rgb(255, 51, 51); color: white;">
                            Occupied<br>
                            Spot No: {{ spot.id }}
                            <a href="{{ url_for('booking.booking_details', lotid=lot.lot_id, spot_id=spot.id) }}">Details</a>
                        </div>
                    {% else %}
                        <div class="parking_spots spot-free" style="background-color: rgb(3, 196, 3); color: white;">
                            Available<br>
                            <br>
                            Spot No: {{ spot.id }}
                        </div>
                    {% endif %}
                {% endfor %}
            </div>
        </div>
    {% endfor %}

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
        <script>
            alert("{{ message }}");
        </script>
        {% endfor %}
      {% endif %}
    {% endwith %}
</body>
</html>
